<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Coverband: <%= Coverband::VERSION %></title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='<%= assets_path('dependencies.js') %>' type='text/javascript'></script>
    <script src='<%= assets_path('application.js') %>' type='text/javascript'></script>
    <link href='<%= assets_path('application.css') %>' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="<%= assets_path("favicon_#{coverage_css_class(result.source_files.covered_percent)}.png") %>" />
    <link rel="icon" type="image/png" href="<%= assets_path('favicon.png') %>" />
  </head>

  <body>
    <div id="loading">
      <img src="<%= assets_path('loading.gif') %>" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div id="header">
        <a href='<%= base_path %>'>Coverband Admin</a> &nbsp;
        <a href='<%= base_path %>settings'>Info</a> &nbsp;
        <% if Coverband.configuration.web_enable_clear %>
          <%= button("#{base_path}clear", 'clear coverage report', delete: true) %>
        <% end %>
        <% if Coverband.configuration.web_debug %>
          <a href='<%= base_path %>debug_data'>Debug Data</a> &nbsp;
        <% end %>
      </div>
      <% if notice.to_s.length > 0 %>
      <div class="notice"><%= notice %></div>
      <% end %>
      <div class="timestamp">Generated <%= timeago(Time.now) %></div>
      <br/>
      <div class="timestamp">
        Coverage Recording Started: <%= timeago(result.source_files.first_seen_at) %>
      </div>

      <ul class="group_tabs">
        <% if Coverband.configuration.track_views %>
          <li><a href='<%= base_path %>view_tracker'>Views Tracker</a></li>
        <% end %>
      </ul>

      <div id="content">
        <%= formatted_file_list("All Files", result, result.source_files) unless view_gems? %>

        <% result.groups.each do |name, files| %>
          <%= formatted_file_list(name, result, files) %>
        <% end %>
      </div>

      <div id="footer">
        Generated by <a href="http://github.com/danmayer/coverband">Coverband</a> v<%= Coverband::VERSION %>
      </div>

      <div class="source_files">
      <% result.source_files.each do |source_file| %>
        <% if (!source_file.gem? || (view_gems? && gem_details? && source_file.gem? )) %>
          <% if static_html? %>
            <%= formatted_source_file(result, source_file) %>
          <% else %>
            <%= formatted_source_file_loader(result, source_file) %>
          <% end %>
        <% end %>
      <% end %>
      </div>
    </div>
  </body>
</html>
